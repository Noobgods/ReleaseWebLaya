!function(t,e){"use strict";class i{static createConstantData(t){let e=new i;return e.add(0,t),e.add(1,t),e}get _elements(){return this._dataBuffer}set _elements(t){let e=t.length;e=e>8?8:e,this._currentLength=e,this._dataBuffer.set(t),this._formatData()}get gradientCount(){return this._currentLength/2}constructor(){this._currentLength=0,this._dataBuffer=new Float32Array(8)}_formatData(){8!=this._currentLength&&1!==this._elements[this._currentLength-2]&&(this._elements[this._currentLength]=1,this._elements[this._currentLength+1]=this._elements[this._currentLength-1])}add(t,e){this._currentLength<8?(6===this._currentLength&&1!==t&&(t=1,console.log("GradientDataNumber warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=t,this._elements[this._currentLength++]=e):console.log("GradientDataNumber warning:data count must lessEqual than 4")}getKeyByIndex(t){return this._elements[2*t]}getValueByIndex(t){return this._elements[2*t+1]}getAverageValue(){for(var t=0,e=0,i=0,s=this._currentLength-2;i<s;i+=2){var n=this._elements[i+1];n+=this._elements[i+3],t+=n*=this._elements[i+2]-this._elements[i],e++}return t/e}cloneTo(t){t._currentLength=this._currentLength;for(var e=t._elements,i=0,s=this._elements.length;i<s;i++)e[i]=this._elements[i]}clone(){var t=new i;return this.cloneTo(t),t}}var s;t.ParticleMinMaxGradientMode=void 0,(s=t.ParticleMinMaxGradientMode||(t.ParticleMinMaxGradientMode={}))[s.Color=0]="Color",s[s.Gradient=1]="Gradient",s[s.TwoColors=2]="TwoColors",s[s.TwoGradients=3]="TwoGradients";const n=new e.Color,r=new e.Color;class a{get color(){return this.colorMin}set color(t){this.colorMin=t}get gradient(){return this.gradientMin}set gradient(t){this.gradientMin=t}constructor(){this.mode=t.ParticleMinMaxGradientMode.Color,this.colorMin=new e.Color(1,1,1,1),this.colorMax=new e.Color(1,1,1,1),this.gradientMin=new e.Gradient,this.gradientMax=new e.Gradient}evaluate(i,s){switch(this.mode){case t.ParticleMinMaxGradientMode.Color:return this.color;case t.ParticleMinMaxGradientMode.Gradient:return this.gradient.evaluateColorRGB(i,n),n;case t.ParticleMinMaxGradientMode.TwoColors:return n.a=e.MathUtil.lerp(this.colorMin.a,this.colorMax.a,s),n.r=e.MathUtil.lerp(this.colorMin.r,this.colorMax.r,s),n.g=e.MathUtil.lerp(this.colorMin.g,this.colorMax.g,s),n.b=e.MathUtil.lerp(this.colorMin.b,this.colorMax.b,s),n;case t.ParticleMinMaxGradientMode.TwoGradients:return this.gradientMin.evaluateColorRGB(i,n),this.gradientMax.evaluateColorRGB(i,r),n.a=e.MathUtil.lerp(n.a,r.a,s),n.r=e.MathUtil.lerp(n.r,r.r,s),n.g=e.MathUtil.lerp(n.g,r.g,s),n.b=e.MathUtil.lerp(n.b,r.b,s),n;default:return e.Color.WHITE}}cloneTo(t){t.mode=this.mode,this.colorMin.cloneTo(t.colorMin),this.colorMax.cloneTo(t.colorMax),this.gradientMin.cloneTo(t.gradientMin),this.gradientMax.cloneTo(t.gradientMax)}clone(){let t=new a;return this.cloneTo(t),t}}class o{constructor(){this.enable=!0,this.color=new a}cloneTo(t){t.enable=this.enable,this.color.cloneTo(t.color)}clone(){var t=new o;return this.cloneTo(t),t}}class l{constructor(){this.time=0,this.count=30}cloneTo(t){t.time=this.time,t.count=this.count}clone(){var t=new l;return this.cloneTo(t),t}}class h{get rateOverTime(){return this._rateOverTime}set rateOverTime(t){this._rateOverTime=t,this._emissionInterval=1/t}get bursts(){return this._bursts}set bursts(t){this._bursts=t,this._sortedBursts=t?t.slice().sort((t,e)=>t.time-e.time):[]}constructor(){this.enable=!0,this._rateOverTime=10,this._lastPosition=new e.Vector3,this.rateOverDistance=0,this._emissionInterval=.1,this._sortedBursts=[]}destroy(){this._sortedBursts=null,this._bursts=null}cloneTo(t){if(t.enable=this.enable,t.rateOverTime=this.rateOverTime,t.rateOverDistance=this.rateOverDistance,this.bursts){let e=[];this.bursts.forEach(t=>{e.push(t.clone())}),t.bursts=e}}clone(){let t=new h;return this.cloneTo(t),t}}var c,u;t.ParticleMinMaxCurveMode=void 0,(c=t.ParticleMinMaxCurveMode||(t.ParticleMinMaxCurveMode={}))[c.Constant=0]="Constant",c[c.Curve=1]="Curve",c[c.TwoConstants=2]="TwoConstants",c[c.TwoCurves=3]="TwoCurves";class d{get constant(){return this._constantMax}set constant(t){this._constantMax=t}get constantMin(){return this._constantMin}set constantMin(t){this._constantMin=t}get constantMax(){return this._constantMax}set constantMax(t){this._constantMax=t}get curve(){return this._curveMax}set curve(t){this._curveMax=t}get curveMin(){return this._curveMin}set curveMin(t){this._curveMin=t}get curveMax(){return this._curveMax}set curveMax(t){this._curveMax=t}constructor(){this.mode=t.ParticleMinMaxCurveMode.Constant,this._constantMin=0,this._constantMax=0,this._curveMin=new i,this._curveMax=new i}evaluate(i,s){switch(this.mode){case t.ParticleMinMaxCurveMode.Constant:return this.constant;case t.ParticleMinMaxCurveMode.TwoConstants:return e.MathUtil.lerp(this.constantMin,this.constantMax,s);case t.ParticleMinMaxCurveMode.Curve:case t.ParticleMinMaxCurveMode.TwoCurves:default:return 0}}destroy(){}cloneTo(t){t.mode=this.mode,t.constantMin=this.constantMin,t.constantMax=this.constantMax,t.curveMin=this.curveMin.clone(),t.curveMax=this.curveMax.clone()}clone(){let t=new d;return this.cloneTo(t),t}}t.TextureSheetAnimationMode=void 0,(u=t.TextureSheetAnimationMode||(t.TextureSheetAnimationMode={}))[u.SingleRow=0]="SingleRow",u[u.WholeSheet=1]="WholeSheet";class M{constructor(){this.enable=!0,this.tiles=new e.Vector2(1,1),this.animation=t.TextureSheetAnimationMode.WholeSheet,this.frame=new d,this.startFrame=new d,this.cycles=1,this._sheetFrameData=new e.Vector4}_calculateSheetFrameData(){let e=this.startFrame,i=e.constant,s=0,n=0;switch(e.mode){case t.ParticleMinMaxCurveMode.Constant:i=e.constant;break;case t.ParticleMinMaxCurveMode.TwoConstants:i=Math.floor(Math.random()*(e.constantMax-e.constantMin)+e.constantMin)}switch(this.animation){case t.TextureSheetAnimationMode.SingleRow:s=this.tiles.x,i%=s,n=this.rowIndex;break;case t.TextureSheetAnimationMode.WholeSheet:s=this.tiles.x*this.tiles.y,i%=s,n=0}this._sheetFrameData.setValue(i,s,n,0)}cloneTo(t){t.enable=this.enable,this.tiles.cloneTo(t.tiles),t.animation=this.animation,t.rowIndex=this.rowIndex,this.frame.cloneTo(t.frame),this.startFrame.cloneTo(t.startFrame),t.cycles=this.cycles}clone(){var t=new M;return this.cloneTo(t),t}}e.ClassUtils.regClass("GradientDataNumber",i),e.ClassUtils.regClass("ParticleMinMaxGradient",a),e.ClassUtils.regClass("ParticleMinMaxCurve",d),e.ClassUtils.regClass("ColorOverLifetimeModule",o),e.ClassUtils.regClass("EmissionModule",h),e.ClassUtils.regClass("EmissionBurst",l),e.ClassUtils.regClass("TextureSheetAnimationModule",M);class _{get particleStride(){return this._particleStride}get particleByteStride(){return this._particleByteStride}get activeParticleCount(){return this.activeEndIndex>=this.activeStartIndex?this.activeEndIndex-this.activeStartIndex:this._maxCount-this.activeStartIndex+this.activeEndIndex}constructor(t,e,i){this._maxCount=t+1,this._particleStride=e/Float32Array.BYTES_PER_ELEMENT,this._particleByteStride=e,this.particleDatas=new Float32Array(this._maxCount*this._particleStride),this.particleInfo=i,this.clear()}clear(){this.activeStartIndex=0,this.activeEndIndex=0,this.updateStartIndex=0,this.updateEndIndex=0}retireParticles(t){for(this.activeStartIndex,this.activeEndIndex;this.activeStartIndex!=this.activeEndIndex;){let e=this.activeStartIndex*this._particleStride,i=this.particleInfo.timeIndex+e,s=t-this.particleDatas[i],n=this.particleInfo.lifetimeIndex+e;if(s<this.particleDatas[n])break;this.activeStartIndex=(this.activeStartIndex+1)%this._maxCount}this.updateStartIndex=this.updateEndIndex=this.activeEndIndex}addParticleData(t){let e=this.activeEndIndex*this._particleStride;this.particleDatas.set(t,e),this.activeEndIndex=(this.activeEndIndex+1)%this._maxCount,this.updateEndIndex=this.activeEndIndex}destroy(){this.clear(),this.particleDatas=null}}t.ColorOverLifetimeModule=o,t.EmissionBurst=l,t.EmissionModule=h,t.GradientDataNumber=i,t.ParticleControler=class{constructor(){this.time=0,this.totalTime=0,this._lastEmitTime=0,this._emitDistance=0,this._nextBurstIndex=0,this._burstLoopCount=0,this._isEmitting=!1,this._isPlaying=!1,this._isPaused=!1,this._isStopped=!0}_initParticlePool(t,e,i){this.particlePool&&this.particlePool.destroy(),this.particlePool=new _(t,e,i)}get isEmitting(){return this._isEmitting}get isPlaying(){return this._isPlaying}get isPaused(){return this._isPaused}get isStopped(){return this._isStopped}play(){this._isEmitting=!0,this._isPlaying=!0,this._isPaused=!1,this._isStopped=!1}pause(){this.isPlaying&&(this._isEmitting=!1,this._isPlaying=!1,this._isPaused=!0,this._isStopped=!1)}stop(){this._isEmitting=!1,this._isPlaying=!1,this._isPaused=!1,this._isStopped=!0,this.clear()}clear(){this.time=0,this.totalTime=0,this._lastEmitTime=0,this._emitDistance=0,this._nextBurstIndex=0,this._burstLoopCount=0,this.particlePool.clear()}destroy(){this.clear(),this.particlePool.destroy(),this.particlePool=null}},t.ParticleInfo=class{constructor(){this.timeIndex=0,this.lifetimeIndex=0}},t.ParticleMinMaxCurve=d,t.ParticleMinMaxGradient=a,t.ParticlePool=_,t.TextureSheetAnimationModule=M}(window.Laya=window.Laya||{},Laya);